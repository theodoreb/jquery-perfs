(function(a){var b=[].slice;a.extend({Deferred:function(g){var f=a.Callbacks("once memory"),e=a.Callbacks("once memory"),d=a.Callbacks("memory"),c="pending",i={resolve:f,reject:e,notify:d},k={done:f.add,fail:e.add,progress:d.add,state:function(){return c},isResolved:f.fired,isRejected:e.fired,then:function(m,l,n){j.done(m).fail(l).progress(n);return this},always:function(){j.done.apply(j,arguments).fail.apply(j,arguments);return this},pipe:function(n,m,l){return a.Deferred(function(o){a.each({done:[n,"resolve"],fail:[m,"reject"],progress:[l,"notify"]},function(q,t){var p=t[0],s=t[1],r;if(a.isFunction(p)){j[q](function(){r=p.apply(this,arguments);if(r&&a.isFunction(r.promise)){r.promise().then(o.resolve,o.reject,o.notify)}else{o[s+"With"](this===j?o:this,[r])}})}else{j[q](o[s])}})}).promise()},promise:function(m){if(m==null){m=k}else{for(var l in k){m[l]=k[l]}}return m}},j=k.promise({}),h;for(h in i){j[h]=i[h].fire;j[h+"With"]=i[h].fireWith}j.done(function(){c="resolved"},e.disable,d.lock).fail(function(){c="rejected"},f.disable,d.lock);if(g){g.call(j,j)}return j},when:function(j){var f=b.call(arguments,0),d=0,c=f.length,k=new Array(c),e=c,g=c,l=c<=1&&j&&a.isFunction(j.promise)?j:a.Deferred(),n=l.promise();function m(o){return function(i){f[o]=arguments.length>1?b.call(arguments,0):i;if(!(--e)){l.resolveWith(l,f)}}}function h(o){return function(i){k[o]=arguments.length>1?b.call(arguments,0):i;l.notifyWith(n,k)}}if(c>1){for(;d<c;d++){if(f[d]&&f[d].promise&&a.isFunction(f[d].promise)){f[d].promise().then(m(d),l.reject,h(d))}else{--e}}if(!e){l.resolveWith(l,f)}}else{if(l!==j){l.resolveWith(l,c?[j]:[])}}return n}})})(jQuery);